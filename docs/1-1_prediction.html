<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Simple Linear Regression</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Simple Linear Regression</h1>

</div>


<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>
<style type="text/css">
script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"
</style>
<script type="text/javascript">
 $(document).ready(function() {
    $('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');
    // onClick function for all plots (img's)
    $('img:not(.zoomImg)').click(function() {
      $('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
      $('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
    });
    // onClick function for zoomImg
    $('img.zoomImg').click(function() {
      $('.zoomDiv').css({opacity: '0', width: '0%'}); 
    });
  });
</script>
<script>var element =  $("div[class="book"]");element.classList.remove("with-summary");</script>
<div id="introduction" class="section level1 fixed-box">
<h1 class="fixed-box">Introduction</h1>
<p>In this tutorial, we will estimate a simple linear regression, make a scatter plot of the data that includes the regression line, and calculate a predicted value for the dependent variable.</p>
</div>
<div id="importing-data-into-r" class="section level1 tabset fixed-height">
<h1 class="tabset fixed-height">Importing data into R</h1>
<div id="lecture" class="section level2">
<h2>Lecture</h2>
<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/qPk0YEKhqB8" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="explanition" class="section level2">
<h2>Explanition</h2>
<p>For this tutorial, we will be using the <code>food</code> data from PoE that can be found at <a href="http://www.principlesofeconometrics.com/poe5/poe5data.html" class="uri">http://www.principlesofeconometrics.com/poe5/poe5data.html</a>. To make it easier to access this data, I have set up a shortened URL: <a href="http://tiny.cc/poe-data" class="uri">http://tiny.cc/poe-data</a>. Thus, to load <code>food.csv</code> into R, use the following URL: <a href="http://tiny.cc/poe-data/food.csv" class="uri">http://tiny.cc/poe-data/food.csv</a>. We will use the <code>read.csv()</code> function along with the <code>url()</code> function as follows.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>food &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="kw">url</span>(<span class="st">&quot;http://tiny.cc/poe-data/food.csv&quot;</span>))</span></code></pre></div>
<p><code>&lt;-</code> is the assignment operator. It is used to store something “into” a an object or variable. For now, think of an object as a box, and <code>&lt;-</code> puts stuff in the box. So in the code fragment above, we are storing the data into an object called <code>food</code>.</p>
<p><code>food</code> is a special object called a data frame. You can think of a data frame as one page of an workbook from a spreadsheet program.</p>
<div class="info-box note">
<p>We need to use the <code>url()</code> function because we are accessing the data file from the internet. If you access data locally, you do not need the <code>url()</code> function.</p>
</div>
</div>
<div id="you-try" class="section level2">
<h2>You try</h2>
<p>Load the food data set into a data frame named food</p>
<div data-datacamp-exercise="" data-height="400" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiIjIGxvYWQgZGF0YSBpbnRvIGFuIG9iamVjdCBjYWxsZWQgZm9vZCIsInNvbHV0aW9uIjoiZm9vZCA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vdGlueS5jYy9wb2UtZGF0YS9mb29kLmNzdlwiKSkiLCJzY3QiOiJ0ZXN0X29iamVjdChjKFwiZm9vZFwiKSlcbnN1Y2Nlc3NfbXNnKHByYWlzZShcIiR7RXhjbGFtYXRpb259ISBZb3UgZGlkIGEgJHthZGplY3RpdmV9IGpvYiFcIikpIn0=
</div>
</div>
</div>
<div id="estimate-a-linear-model" class="section level1 tabset fixed-height">
<h1 class="tabset fixed-height">Estimate a linear model</h1>
<div id="lecture-1" class="section level2">
<h2>Lecture</h2>
</div>
<div id="explanition-1" class="section level2">
<h2>Explanition</h2>
<p>In r, the <code>lm()</code> function is used to estimate linear regression models. The “lm” stands for linear model. <code>lm()</code> used by itself does not show any output; thus, it is useful to give the model a name, such as <code>mod1</code>, then show the results using <code>summary(mod1)</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(food_exp <span class="op">~</span><span class="st"> </span>income, <span class="dt">data =</span> food)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">summary</span>(mod1)</span></code></pre></div>
<pre><code>
Call:
lm(formula = food_exp ~ income, data = food)

Residuals:
     Min       1Q   Median       3Q      Max 
-223.025  -50.816   -6.324   67.879  212.044 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   83.416     43.410   1.922   0.0622 .  
income        10.210      2.093   4.877 1.95e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 89.52 on 38 degrees of freedom
Multiple R-squared:  0.385, Adjusted R-squared:  0.3688 
F-statistic: 23.79 on 1 and 38 DF,  p-value: 1.946e-05</code></pre>
</div>
<div id="you-try-1" class="section level2">
<h2>You try</h2>
<p>Regress <code>food_exp</code> on <code>income</code> and store the model in an object named <code>mod1</code> then display a summary of the model.</p>
<div data-datacamp-exercise="" data-height="400" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImZvb2QgPC0gcmVhZC5jc3YodXJsKFwiaHR0cDovL3RpbnkuY2MvcG9lLWRhdGEvZm9vZC5jc3ZcIikpIiwic2FtcGxlIjoiIyBzdG9yZSBsaW5lYXIgbW9kZWwgaW4gYW4gb2JqZWN0IG5hbWVkICdtb2QxJyIsInNvbHV0aW9uIjoibW9kMSA8LSBsbShmb29kX2V4cCB+IGluY29tZSwgZGF0YSA9IGZvb2QpXG5zdW1tYXJ5KG1vZDEpIiwic2N0IjoidGVzdF9vYmplY3QoYyhcIm1vZDFcIikpXG5zdWNjZXNzX21zZyhwcmFpc2UoXCIke0V4Y2xhbWF0aW9ufSEgWW91IGRpZCBhICR7YWRqZWN0aXZlfSBqb2IhXCIpKSJ9
</div>
</div>
</div>
<div id="plot-the-model" class="section level1 tabset fixed-height">
<h1 class="tabset fixed-height">Plot the model</h1>
<div id="lecture-2" class="section level2">
<h2>Lecture</h2>
</div>
<div id="explanition-2" class="section level2">
<h2>Explanition</h2>
<p>It is always a good idea to plot the data along with the regression line. The <code>plot()</code> function and do this, and the <code>abline()</code> function add the regression line. <code>abline()</code> requires the coefficients. We can also retrieve the coefficients using the <code>coef()</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>b1 &lt;-<span class="st"> </span><span class="kw">coef</span>(mod1)[[<span class="dv">1</span>]]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>b2 &lt;-<span class="st"> </span><span class="kw">coef</span>(mod1)[[<span class="dv">2</span>]]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="kw">plot</span>(food<span class="op">$</span>income, food<span class="op">$</span>food_exp, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>     <span class="dt">xlab=</span><span class="st">&quot;weekly income in $100&quot;</span>, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>     <span class="dt">ylab=</span><span class="st">&quot;weekly food expenditure in $&quot;</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>     <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="kw">abline</span>(b1,b2)</span></code></pre></div>
<p><img src="1-1_prediction_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="info-box warning">
<p>Notice that the scatter plot indicates a non-linear relationship between food expenditure and income. Thus, the linear model we have estimated is likely inappropriate. We will estimate a better model in a later lesson.</p>
</div>
</div>
<div id="you-try-2" class="section level2">
<h2>You try</h2>
<p>Retrieve the regression line coefficients and then plot the data and regression line.</p>
<div data-datacamp-exercise="" data-height="400" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImZvb2QgPC0gcmVhZC5jc3YodXJsKFwiaHR0cDovL3RpbnkuY2MvcG9lLWRhdGEvZm9vZC5jc3ZcIikpXG5tb2QxIDwtIGxtKGZvb2RfZXhwIH4gaW5jb21lLCBkYXRhID0gZm9vZCkiLCJzYW1wbGUiOiIjIHN0b3JlIGxpbmVhciBtb2RlbCBpbiBhbiBvYmplY3QgbmFtZWQgJ21vZDEnIiwic29sdXRpb24iOiJiMSA8LSBjb2VmKG1vZDEpW1sxXV1cbmIyIDwtIGNvZWYobW9kMSlbWzJdXVxuXG5wbG90KGZvb2QkaW5jb21lLCBmb29kJGZvb2RfZXhwLCBcbiAgICAgeGxhYj1cIndlZWtseSBpbmNvbWUgaW4gJDEwMFwiLCBcbiAgICAgeWxhYj1cIndlZWtseSBmb29kIGV4cGVuZGl0dXJlIGluICRcIiwgXG4gICAgIHR5cGUgPSBcInBcIilcbmFibGluZShiMSxiMikiLCJzY3QiOiJ0ZXN0X29iamVjdChjKFwiYjFcIikpXG5zdWNjZXNzX21zZyhwcmFpc2UoXCIke0V4Y2xhbWF0aW9ufSEgWW91IGRpZCBhICR7YWRqZWN0aXZlfSBqb2IhXCIpKVxudGVzdF9vYmplY3QoYyhcImIyXCIpKVxuc3VjY2Vzc19tc2cocHJhaXNlKFwiJHtFeGNsYW1hdGlvbn0hIFlvdSBkaWQgYSAke2FkamVjdGl2ZX0gam9iIVwiKSkifQ==
</div>
</div>
</div>
<div id="prediction" class="section level1 tabset fixed-height">
<h1 class="tabset fixed-height">Prediction</h1>
<div id="lecture-3" class="section level2">
<h2>Lecture</h2>
</div>
<div id="explanition-3" class="section level2">
<h2>Explanition</h2>
<p>The <code>predict()</code> function can be used in R to calculate the predicted value of the dependent variable, <code>food_exp</code> for given values of income, as well as the confidence and prediction intervals for that estimate. Let’s predict the level of expenditure on food, <code>food_exp</code>, when income equals 20.</p>
<p>First, we need to create a new data frame that contains the values of the dependent variable for which we want a prediction. The function <code>data.frame()</code> is used to create the new data frame.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>new.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;income&quot;</span> =<span class="st"> </span><span class="dv">20</span>)</span></code></pre></div>
<p>Second, use the <code>predict()</code> function to create objects with the confidence interval and the prediction interval.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">predict</span>(mod1, <span class="dt">newdata=</span>new.data, <span class="dt">interval=</span><span class="st">&quot;confidence&quot;</span>, <span class="dt">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">fit</th>
<th align="right">lwr</th>
<th align="right">upr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">287.6089</td>
<td align="right">258.9069</td>
<td align="right">316.3108</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">predict</span>(mod1, <span class="dt">newdata=</span>new.data, <span class="dt">interval=</span><span class="st">&quot;predict&quot;</span>, <span class="dt">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">fit</th>
<th align="right">lwr</th>
<th align="right">upr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">287.6089</td>
<td align="right">104.1323</td>
<td align="right">471.0854</td>
</tr>
</tbody>
</table>
</div>
<div id="you-try-3" class="section level2">
<h2>You try</h2>
<p>Calculate the predicted value of <code>food_exp</code>, as well as the confidence and prediction intervals for that estimate, when <code>income</code> is equal to 15.</p>
<div data-datacamp-exercise="" data-height="400" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImZvb2QgPC0gcmVhZC5jc3YodXJsKFwiaHR0cDovL3RpbnkuY2MvcG9lLWRhdGEvZm9vZC5jc3ZcIikpXG5tb2QxIDwtIGxtKGZvb2RfZXhwIH4gaW5jb21lLCBkYXRhID0gZm9vZCkiLCJzYW1wbGUiOiIjIHN0b3JlIGNvbmZpZGVuY2UgaW50ZXJ2YWwgaW4gYW4gb2JqZWN0IG5hbWVkICdjaSdcblxuXG4jIHN0b3JlIHByZWRpY3Rpb24gaW50ZXJ2YWwgaW4gYW4gb2JqZWN0IG5hbWVkICdwaSciLCJzb2x1dGlvbiI6Im5ldy5kYXRhIDwtIGRhdGEuZnJhbWUoXCJpbmNvbWVcIiA9IDE1KVxuY2kgPC0gcHJlZGljdChtb2QxLCBuZXdkYXRhPW5ldy5kYXRhLCBpbnRlcnZhbD1cImNvbmZpZGVuY2VcIiwgbGV2ZWw9MC45NSlcbmNpXG5cbnBpIDwtIHByZWRpY3QobW9kMSwgbmV3ZGF0YT1uZXcuZGF0YSwgaW50ZXJ2YWw9XCJwcmVkaWN0XCIsIGxldmVsPTAuOTUpXG5waSIsInNjdCI6InRlc3Rfb2JqZWN0KGMoXCJjaVwiKSlcbnN1Y2Nlc3NfbXNnKFwiR3JlYXQhXCIpXG50ZXN0X29iamVjdChjKFwicGlcIikpXG5zdWNjZXNzX21zZyhwcmFpc2UoXCIke0V4Y2xhbWF0aW9ufSEgWW91IGRpZCBhICR7YWRqZWN0aXZlfSBqb2IhXCIpKSJ9
</div>
</div>
</div>
<div id="prediction-probability" class="section level1 tabset fixed-height">
<h1 class="tabset fixed-height">Prediction Probability</h1>
<div id="lecture-4" class="section level2">
<h2>Lecture</h2>
</div>
<div id="explanition-4" class="section level2">
<h2>Explanition</h2>
<p>It can be quite useful to determine the probability of a range of events rather than a single value. For example, we might want to predict the probability that a household with an income of 20 will spend at least $200 dollars per week on food.</p>
<div class="info-box warning">
<p>This sections gets a bit technical, but I will provide you with a function that you can cut and past into your analysis that makes answering questions like the one above much easier.</p>
</div>
<div id="some-theory" class="section level3">
<h3>Some theory</h3>
<p>The estimate of <span class="math inline">\(y\)</span>, i.e. <span class="math inline">\(\hat{y}\)</span>, is a random variable with a student’s t distribution. So we can use <code>pt()</code> to estimate the probably of an actual realization of <span class="math inline">\(y\)</span> being within a given range.</p>
<p>We first need to calculate a <span class="math inline">\(t-stat\)</span> for a value that is either the max or min of the given range. This <span class="math inline">\(t-stat\)</span> can be found with the equation below.</p>
<div id="eq1">

</div>
<p><span class="math display">\[
t-stat = \frac{value - \hat{y}}{ standard\ error\ of\ prediction }
\]</span></p>
<p>Unfortunately, R dose not provide an easy way to access the standard error of prediction. So I have written two functions <code>predict.prob ()</code> and <code>predict.plot ()</code> to make this procedure easier. Those two function are included in the next tab. You do not need to worry about understanding the function. You can simply cut and past the functions into you own projects.</p>
</div>
<div id="calculate-the-probibility" class="section level3">
<h3>Calculate the probibility</h3>
<p>Here we will predict the probability that a household with an income of 20 will spend at least $200 dollars per week on food. Recall that we estimate a model of food expenditure called <code>mod1</code>.</p>
<p>First we will use <code>predict.prob()</code> to find both the probability of food expenditure being greater than $200 and the actual prediction of food expenditure.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>mod1.prod &lt;-<span class="st"> </span><span class="kw">predict.prob</span>(mod1,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>              <span class="dt">new.data =</span> <span class="kw">data.frame</span>(<span class="st">&quot;income&quot;</span>=<span class="dv">20</span>),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>              <span class="dt">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>              alternative &lt;-<span class="st"> &quot;greater&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>              value &lt;-<span class="st"> </span><span class="dv">200</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a><span class="kw">kable</span>(mod1.prod, <span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">align =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">value</th>
<th align="left">prob</th>
<th align="left">alternative</th>
<th align="left">fit</th>
<th align="left">upr</th>
<th align="left">lwr</th>
<th align="left">df</th>
<th align="left">cv</th>
<th align="left">se</th>
<th align="left">t.stat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">200</td>
<td align="left">0.83</td>
<td align="left">greater</td>
<td align="left">287.609</td>
<td align="left">471.085</td>
<td align="left">104.132</td>
<td align="left">38</td>
<td align="left">2.024</td>
<td align="left">90.633</td>
<td align="left">-0.967</td>
</tr>
</tbody>
</table>
<p>Next, you can use <code>predict.prob()</code> to visualize the probability we just estimated. The horizontal axis is measured in the same scale as the <span class="math inline">\(t-score\)</span>, thus the zero coresponds to the predicted value of <span class="math inline">\(y\)</span>, and the shading corresponds to the</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">predict.plot</span>(mod1.prod)</span></code></pre></div>
<p><img src="1-1_prediction_files/figure-html/unnamed-chunk-22-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="prediction-functions" class="section level2">
<h2>Prediction Functions</h2>
<div id="predict.prob" class="section level3">
<h3>predict.prob ()</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a>predict.prob &lt;-<span class="st"> </span><span class="cf">function</span>(lmod,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>                      new.data,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>                      <span class="dt">alpha=</span><span class="fl">0.05</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>                      <span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a>                      value)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>  {</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a>    prediction &lt;-<span class="st"> </span><span class="kw">predict</span>(lmod, </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>                          <span class="dt">newdata =</span> new.data,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a>                          <span class="dt">interval=</span><span class="st">&quot;predict&quot;</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a>                          <span class="dt">level =</span><span class="dv">1</span><span class="op">-</span>alpha,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a>                          <span class="dt">se.fit =</span> T)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a>    cv &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dt">p=</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> prediction<span class="op">$</span>df, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a>    se &lt;-<span class="st"> </span>(prediction<span class="op">$</span>fit[,<span class="st">&quot;upr&quot;</span>] <span class="op">-</span><span class="st"> </span>prediction<span class="op">$</span>fit[,<span class="st">&quot;fit&quot;</span>])<span class="op">/</span>cv</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>    t.stat &lt;-<span class="st"> </span>(value<span class="op">-</span>prediction<span class="op">$</span>fit[,<span class="st">&quot;fit&quot;</span>])<span class="op">/</span>se</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a>    ret =<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;value&quot;</span>=value,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a>                     <span class="st">&quot;prob&quot;</span>=<span class="kw">pt</span>(<span class="dt">q=</span>t.stat,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true"></a>                            <span class="dt">df=</span>prediction<span class="op">$</span>df,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true"></a>                            <span class="dt">lower.tail =</span> (alternative<span class="op">==</span><span class="st">&quot;less&quot;</span>)),</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true"></a>                     <span class="st">&quot;alternative&quot;</span>=alternative,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true"></a>                     <span class="st">&quot;fit&quot;</span>=prediction<span class="op">$</span>fit[,<span class="st">&quot;fit&quot;</span>],</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true"></a>                     <span class="st">&quot;upr&quot;</span>=prediction<span class="op">$</span>fit[,<span class="st">&quot;upr&quot;</span>],</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true"></a>                     <span class="st">&quot;lwr&quot;</span>=prediction<span class="op">$</span>fit[,<span class="st">&quot;lwr&quot;</span>],</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true"></a>                     <span class="st">&quot;df&quot;</span> =<span class="st"> </span>prediction<span class="op">$</span>df,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true"></a>                     <span class="st">&quot;cv&quot;</span> =<span class="st"> </span>cv,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true"></a>                     <span class="st">&quot;se&quot;</span> =<span class="st"> </span>se,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true"></a>                     <span class="st">&quot;t.stat&quot;</span> =<span class="st"> </span>t.stat</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true"></a>                     )</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true"></a>    <span class="kw">return</span>(ret)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true"></a>  }</span></code></pre></div>
</div>
<div id="predict.plot" class="section level3">
<h3>predict.plot()</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>predict.plot &lt;-<span class="st"> </span><span class="cf">function</span>(prediction){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>  x=<span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="dt">length=</span><span class="dv">400</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>  y=<span class="kw">dt</span>(x, <span class="dt">df=</span>prediction<span class="op">$</span>df)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>  t =<span class="st"> </span><span class="kw">ifelse</span>((prediction<span class="op">$</span>alternative<span class="op">==</span><span class="st">&quot;less&quot;</span>),<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)  </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>  x1=<span class="kw">seq</span>(t<span class="op">*</span><span class="dv">4</span>,prediction<span class="op">$</span>t.stat,<span class="dt">length=</span><span class="dv">400</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>  y1=<span class="kw">dt</span>(x1, <span class="dt">df=</span>prediction<span class="op">$</span>df)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>  <span class="kw">plot</span>(x,y,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>  <span class="kw">polygon</span>(<span class="kw">c</span>(<span class="dv">4</span>,prediction<span class="op">$</span>t.stat,x1),<span class="kw">c</span>(<span class="dv">0</span>,y1,<span class="dv">0</span>),<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>  <span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>}</span></code></pre></div>
</div>
</div>
<div id="you-try-4" class="section level2">
<h2>You try</h2>
<p>Instructions here</p>
<div data-datacamp-exercise="" data-height="400" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoa25pdHIpXG5wcmVkaWN0LnByb2IgPC0gZnVuY3Rpb24obG1vZCxcbiAgICAgICAgICAgICAgICAgICAgICBuZXcuZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICBhbHBoYT0wLjA1LFxuICAgICAgICAgICAgICAgICAgICAgIGFsdGVybmF0aXZlPVwiZ3JlYXRlclwiLFxuICAgICAgICAgICAgICAgICAgICAgIHZhbHVlKVxuICB7XG4gICAgcHJlZGljdGlvbiA8LSBwcmVkaWN0KGxtb2QsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdkYXRhID0gbmV3LmRhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGludGVydmFsPVwicHJlZGljdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbCA9MS1hbHBoYSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2UuZml0ID0gVClcbiAgICBjdiA8LSBxdChwPWFscGhhLzIsIGRmID0gcHJlZGljdGlvbiRkZiwgbG93ZXIudGFpbCA9IEZBTFNFKVxuICAgIHNlIDwtIChwcmVkaWN0aW9uJGZpdFssXCJ1cHJcIl0gLSBwcmVkaWN0aW9uJGZpdFssXCJmaXRcIl0pL2N2XG4gICAgdC5zdGF0IDwtICh2YWx1ZS1wcmVkaWN0aW9uJGZpdFssXCJmaXRcIl0pL3NlXG4gICAgcmV0ID0gZGF0YS5mcmFtZShcInZhbHVlXCI9dmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICBcInByb2JcIj1wdChxPXQuc3RhdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZj1wcmVkaWN0aW9uJGRmLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyLnRhaWwgPSAoYWx0ZXJuYXRpdmU9PVwibGVzc1wiKSksXG4gICAgICAgICAgICAgICAgICAgICBcImFsdGVybmF0aXZlXCI9YWx0ZXJuYXRpdmUsXG4gICAgICAgICAgICAgICAgICAgICBcImZpdFwiPXByZWRpY3Rpb24kZml0WyxcImZpdFwiXSxcbiAgICAgICAgICAgICAgICAgICAgIFwidXByXCI9cHJlZGljdGlvbiRmaXRbLFwidXByXCJdLFxuICAgICAgICAgICAgICAgICAgICAgXCJsd3JcIj1wcmVkaWN0aW9uJGZpdFssXCJsd3JcIl0sXG4gICAgICAgICAgICAgICAgICAgICBcImRmXCIgPSBwcmVkaWN0aW9uJGRmLFxuICAgICAgICAgICAgICAgICAgICAgXCJjdlwiID0gY3YsXG4gICAgICAgICAgICAgICAgICAgICBcInNlXCIgPSBzZSxcbiAgICAgICAgICAgICAgICAgICAgIFwidC5zdGF0XCIgPSB0LnN0YXRcbiAgICAgICAgICAgICAgICAgICAgIClcbiAgICByZXR1cm4ocmV0KVxuICB9XG5cbnByZWRpY3QucGxvdCA8LSBmdW5jdGlvbihwcmVkaWN0aW9uKXtcbiAgeD1zZXEoLTQsNCxsZW5ndGg9NDAwKVxuICB5PWR0KHgsIGRmPXByZWRpY3Rpb24kZGYpXG4gIHQgPSBpZmVsc2UoKHByZWRpY3Rpb24kYWx0ZXJuYXRpdmU9PVwibGVzc1wiKSwtMSwxKSAgXG4gIHgxPXNlcSh0KjQscHJlZGljdGlvbiR0LnN0YXQsbGVuZ3RoPTQwMClcbiAgeTE9ZHQoeDEsIGRmPXByZWRpY3Rpb24kZGYpXG4gIHBsb3QoeCx5LHR5cGU9XCJsXCIsIGx3ZD0yLCBjb2w9XCJibGFja1wiKVxuICBwb2x5Z29uKGMoNCxwcmVkaWN0aW9uJHQuc3RhdCx4MSksYygwLHkxLDApLGNvbD1cImdyYXlcIilcbiAgYWJsaW5lKHY9MClcbn1cblxuXG5mb29kIDwtIHJlYWQuY3N2KHVybChcImh0dHA6Ly90aW55LmNjL3BvZS1kYXRhL2Zvb2QuY3N2XCIpKVxubW9kMSA8LSBsbShmb29kX2V4cCB+IGluY29tZSwgZGF0YSA9IGZvb2QpIiwic2FtcGxlIjoiIyBQcmVkaWN0IHByb2JhYmlsaXR5IG9mIGZvb2QgZXhwZW5kaXR1cmUgYmVpbmcgYXQgbGVhc3QgJDE1MCBmb3IgYSBob3VzZWhvbGQgd2l0aCBpbmNvbWUgbGV2ZWwgb2YgMTUiLCJzb2x1dGlvbiI6Im1vZDEucHJvZCA8LSBwcmVkaWN0LnByb2IobW9kMSxcbiAgICAgICAgICAgICAgbmV3LmRhdGEgPSBkYXRhLmZyYW1lKFwiaW5jb21lXCI9MTUpLFxuICAgICAgICAgICAgICBhbHBoYSA9IDAuMDUsXG4gICAgICAgICAgICAgIGFsdGVybmF0aXZlIDwtIFwiZ3JlYXRlclwiLFxuICAgICAgICAgICAgICB2YWx1ZSA8LSAxNTApXG5cbm1vZDEucHJvZCRwcm9iXG5cbnByZWRpY3QucGxvdChtb2QxLnByb2QpIiwic2N0IjoidGVzdF9vYmplY3QoXCJtb2QxLnByb2RcIilcbnN1Y2Nlc3NfbXNnKHByYWlzZShcIiR7RXhjbGFtYXRpb259ISBZb3UgZGlkIGEgJHthZGplY3RpdmV9IGpvYiFcIikpIn0=
</div>
</div>
</div>
<div id="summary-of-all-code" class="section level1">
<h1>Summary of all code</h1>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="co"># Packages </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="kw">library</span>(knitr)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a><span class="co"># Functions </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>predict.prob &lt;-<span class="st"> </span><span class="cf">function</span>(lmod,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a>                      new.data,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a>                      <span class="dt">alpha=</span><span class="fl">0.05</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a>                      <span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a>                      value)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a>  {</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a>    prediction &lt;-<span class="st"> </span><span class="kw">predict</span>(lmod, </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a>                          <span class="dt">newdata =</span> new.data,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a>                          <span class="dt">interval=</span><span class="st">&quot;predict&quot;</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a>                          <span class="dt">level =</span><span class="dv">1</span><span class="op">-</span>alpha,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true"></a>                          <span class="dt">se.fit =</span> T)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true"></a>    cv &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dt">p=</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> prediction<span class="op">$</span>df, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true"></a>    se &lt;-<span class="st"> </span>(prediction<span class="op">$</span>fit[,<span class="st">&quot;upr&quot;</span>] <span class="op">-</span><span class="st"> </span>prediction<span class="op">$</span>fit[,<span class="st">&quot;fit&quot;</span>])<span class="op">/</span>cv</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true"></a>    t.stat &lt;-<span class="st"> </span>(value<span class="op">-</span>prediction<span class="op">$</span>fit[,<span class="st">&quot;fit&quot;</span>])<span class="op">/</span>se</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true"></a>    ret =<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;value&quot;</span>=value,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true"></a>                     <span class="st">&quot;prob&quot;</span>=<span class="kw">pt</span>(<span class="dt">q=</span>t.stat,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true"></a>                            <span class="dt">df=</span>prediction<span class="op">$</span>df,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true"></a>                            <span class="dt">lower.tail =</span> (alternative<span class="op">==</span><span class="st">&quot;less&quot;</span>)),</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true"></a>                     <span class="st">&quot;alternative&quot;</span>=alternative,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true"></a>                     <span class="st">&quot;fit&quot;</span>=prediction<span class="op">$</span>fit[,<span class="st">&quot;fit&quot;</span>],</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true"></a>                     <span class="st">&quot;upr&quot;</span>=prediction<span class="op">$</span>fit[,<span class="st">&quot;upr&quot;</span>],</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true"></a>                     <span class="st">&quot;lwr&quot;</span>=prediction<span class="op">$</span>fit[,<span class="st">&quot;lwr&quot;</span>],</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true"></a>                     <span class="st">&quot;df&quot;</span> =<span class="st"> </span>prediction<span class="op">$</span>df,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true"></a>                     <span class="st">&quot;cv&quot;</span> =<span class="st"> </span>cv,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true"></a>                     <span class="st">&quot;se&quot;</span> =<span class="st"> </span>se,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true"></a>                     <span class="st">&quot;t.stat&quot;</span> =<span class="st"> </span>t.stat</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true"></a>                     )</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true"></a>    <span class="kw">return</span>(ret)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true"></a>  }</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true"></a>predict.plot &lt;-<span class="st"> </span><span class="cf">function</span>(prediction){</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true"></a>  x=<span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="dt">length=</span><span class="dv">400</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true"></a>  y=<span class="kw">dt</span>(x, <span class="dt">df=</span>prediction<span class="op">$</span>df)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true"></a>  t =<span class="st"> </span><span class="kw">ifelse</span>((prediction<span class="op">$</span>alternative<span class="op">==</span><span class="st">&quot;less&quot;</span>),<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)  </span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true"></a>  x1=<span class="kw">seq</span>(t<span class="op">*</span><span class="dv">4</span>,prediction<span class="op">$</span>t.stat,<span class="dt">length=</span><span class="dv">400</span>)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true"></a>  y1=<span class="kw">dt</span>(x1, <span class="dt">df=</span>prediction<span class="op">$</span>df)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true"></a>  <span class="kw">plot</span>(x,y,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true"></a>  <span class="kw">polygon</span>(<span class="kw">c</span>(<span class="dv">4</span>,prediction<span class="op">$</span>t.stat,x1),<span class="kw">c</span>(<span class="dv">0</span>,y1,<span class="dv">0</span>),<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true"></a>  <span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>)</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true"></a>}</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true"></a><span class="co"># Code</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true"></a><span class="co">## Load Data</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true"></a>food &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="kw">url</span>(<span class="st">&quot;http://tiny.cc/poe-data/food.csv&quot;</span>))</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true"></a></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true"></a><span class="co">## Estimate Model</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true"></a>mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(food_exp <span class="op">~</span><span class="st"> </span>income, <span class="dt">data =</span> food)</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true"></a><span class="kw">summary</span>(mod1)</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true"></a></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true"></a><span class="co">## Plot Model</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true"></a>b1 &lt;-<span class="st"> </span><span class="kw">coef</span>(mod1)[[<span class="dv">1</span>]]</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true"></a>b2 &lt;-<span class="st"> </span><span class="kw">coef</span>(mod1)[[<span class="dv">2</span>]]</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true"></a><span class="kw">plot</span>(food<span class="op">$</span>income, food<span class="op">$</span>food_exp, </span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true"></a>     <span class="dt">xlab=</span><span class="st">&quot;weekly income in $100&quot;</span>, </span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true"></a>     <span class="dt">ylab=</span><span class="st">&quot;weekly food expenditure in $&quot;</span>, </span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true"></a>     <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>)</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true"></a><span class="kw">abline</span>(b1,b2)</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true"></a></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true"></a><span class="co"># Make Predictions with the Model</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true"></a>new.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;income&quot;</span> =<span class="st"> </span><span class="dv">20</span>)</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true"></a><span class="kw">predict</span>(mod1, <span class="dt">newdata=</span>new.data, <span class="dt">interval=</span><span class="st">&quot;confidence&quot;</span>, <span class="dt">level=</span><span class="fl">0.95</span>)</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true"></a><span class="kw">predict</span>(mod1, <span class="dt">newdata=</span>new.data, <span class="dt">interval=</span><span class="st">&quot;predict&quot;</span>, <span class="dt">level=</span><span class="fl">0.95</span>)</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true"></a></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true"></a><span class="co"># Make Probability Predictions</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true"></a>mod1.prod &lt;-<span class="st"> </span><span class="kw">predict.prob</span>(mod1,</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true"></a>              <span class="dt">new.data =</span> <span class="kw">data.frame</span>(<span class="st">&quot;income&quot;</span>=<span class="dv">20</span>),</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true"></a>              <span class="dt">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true"></a>              alternative &lt;-<span class="st"> &quot;greater&quot;</span>,</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true"></a>              value &lt;-<span class="st"> </span><span class="dv">200</span>)</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true"></a></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true"></a><span class="kw">kable</span>(mod1.prod, <span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">align =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true"></a></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true"></a><span class="co"># Plot Probability Predictions</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true"></a><span class="kw">predict.plot</span>(mod1.prod)</span></code></pre></div>
</div>
<div id="you-did-it" class="section level1 fixed-box">
<h1 class="fixed-box">You did it!</h1>
<p>In the next tutorial, we will learn about accessing Goodness-of-Fit. The next lesson is available here: <a href="https://logan-kelly.shinyapps.io/4-2_GoF/" class="uri">https://logan-kelly.shinyapps.io/4-2_GoF/</a></p>
<p><img src="img/great-job-star-drawing.jpeg" style="width:75.0%" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
